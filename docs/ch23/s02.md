# 2. 指针类型的参数和返回值

首先看以下程序：

**例 23.1. 指针参数和返回值**

```c
#include <stdio.h>

int *swap(int *px, int *py)
{
    int temp;
    temp = *px;
    *px = *py;
    *py = temp;
    return px;
}

int main(void)
{
    int i = 10, j = 20;
    int *p = swap(&i, &j);
    printf("now i=%d j=%d *p=%d\n", i, j, *p);
    return 0;
}
```

我们知道，调用函数的传参过程相当于用实参定义并初始化形参，`swap(&i, &j)`这个调用相当于：

```c
int *px = &i;
int *py = &j;
```

所以`px`和`py`分别指向`main`函数的局部变量`i`和`j`，在`swap`函数中读写`*px`和`*py`其实是读写`main`函数的`i`和`j`。尽管在`swap`函数的作用域中访问不到`i`和`j`这两个变量名，却可以通过地址访问它们，最终`swap`函数将`i`和`j`的值做了交换。

上面的例子还演示了函数返回值是指针的情况，`return px;`语句相当于定义了一个临时变量并用`px`初始化：

```c
int *tmp = px;
```

然后临时变量`tmp`的值成为表达式`swap(&i, &j)`的值，然后在`main`函数中又把这个值赋给了p，相当于：

```c
int *p = tmp;
```

最后的结果是`swap`函数的`px`指向哪就让`main`函数的`p`指向哪。我们知道`px`指向`i`，所以`p`也指向`i`。

## 习题

1. 对照本节的描述，像[图 23.1 "指针的基本概念"](./s01.md#pointer.pointer0)那样画图理解函数的调用和返回过程。在下一章我们会看到更复杂的参数和返回值形式，在初学阶段对每个程序都要画图理解它的运行过程，只要基本概念清晰，无论多复杂的形式都应该能正确分析。

2. 现在回头看[第 3 节 "形参和实参"](../ch03/s03.md#func.paraarg)的习题1，那个程序应该怎么改？ 